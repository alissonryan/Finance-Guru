{
    "version": "1.0",
    "description": "Skill activation triggers for Claude Code. Controls when skills automatically suggest or block actions.",
    "skills": {
        "skill-developer": {
            "type": "domain",
            "enforcement": "block",
            "priority": "high",
            "description": "Meta-skill for creating and managing Claude Code skills",
            "promptTriggers": {
                "keywords": [
                    "skill system",
                    "create skill",
                    "add skill",
                    "skill triggers",
                    "skill rules",
                    "hook system",
                    "skill development",
                    "skill-rules.json"
                ],
                "intentPatterns": [
                    "(how do|how does|explain).*?skill",
                    "(create|add|modify|build).*?skill",
                    "skill.*?(work|trigger|activate|system)"
                ]
            }
        },
        "error-tracking": {
            "type": "domain",
            "enforcement": "suggest",
            "priority": "high",
            "description": "Sentry error tracking and performance monitoring patterns",
            "promptTriggers": {
                "keywords": [
                    "error handling",
                    "exception",
                    "sentry",
                    "error tracking",
                    "captureException",
                    "monitoring",
                    "performance tracking"
                ],
                "intentPatterns": [
                    "(add|create|implement|setup).*?(error handling|sentry|error tracking)",
                    "(fix|handle|catch).*?(error|exception)",
                    "(how to|best practice).*?(error|sentry|monitoring)"
                ]
            },
            "fileTriggers": {
                "pathPatterns": [
                    "backend/app/**/*.py",
                    "backend/app/api/**/*.py",
                    "backend/app/services/**/*.py",
                    "backend/app/core/**/*.py"
                ],
                "contentPatterns": [
                    "import sentry_sdk",
                    "from sentry_sdk",
                    "sentry_sdk\\.",
                    "capture_exception",
                    "capture_message"
                ]
            }
        },
        "portfolio-syncing": {
            "type": "domain",
            "enforcement": "block",
            "priority": "critical",
            "description": "Import and sync portfolio data from Fidelity CSV exports to Google Sheets Portfolio Positions. Handles safety checks, position updates, and formula validation.",
            "promptTriggers": {
                "keywords": [
                    "import fidelity",
                    "fidelity csv",
                    "sync portfolio",
                    "update positions",
                    "portfolio import",
                    "csv import",
                    "portfolio sync",
                    "fidelity export",
                    "import csv",
                    "sync positions"
                ],
                "intentPatterns": [
                    "(import|update|sync|load).*?(fidelity|portfolio|positions|csv)",
                    "new.*?(fidelity csv|portfolio export)",
                    "(update|refresh).*?(portfolio|positions).*?(fidelity|csv)",
                    "(import|sync).*?(portfolio_positions|positions csv)"
                ]
            },
            "fileTriggers": {
                "pathPatterns": [
                    "notebooks/updates/Portfolio_Positions_*.csv",
                    "notebooks/updates/Balances_for_Account_*.csv"
                ],
                "contentPatterns": [
                    "Symbol,Quantity",
                    "Average Cost Basis",
                    "Portfolio_Positions",
                    "Account Number,Account Name,Symbol"
                ]
            }
        },
        "dividend-tracking": {
            "type": "domain",
            "enforcement": "suggest",
            "priority": "high",
            "description": "Sync dividend portfolio data between Portfolio Positions and Dividend Tracker. Cross-references Layer 2 holdings, updates shares, calculates income.",
            "promptTriggers": {
                "keywords": [
                    "dividend tracker",
                    "sync dividends",
                    "update dividends",
                    "dividend income",
                    "layer 2 income",
                    "dividend portfolio",
                    "drip status",
                    "dividend payments",
                    "expected dividends",
                    "monthly income"
                ],
                "intentPatterns": [
                    "(sync|update|refresh).*?(dividend tracker|dividends)",
                    "(calculate|check).*?(dividend income|expected dividends)",
                    "update.*?(layer 2|income portfolio)",
                    "(add|track).*?(dividend fund|income fund)"
                ]
            },
            "fileTriggers": {
                "pathPatterns": [
                    "fin-guru/data/*dividend*.md",
                    "docs/fin-guru/strategies/active/*dividend*.md",
                    "fin-guru/data/user-profile.yaml"
                ]
            }
        },
        "margin-management": {
            "type": "domain",
            "enforcement": "block",
            "priority": "critical",
            "description": "Update Margin Dashboard with Fidelity balances. Calculates margin metrics, coverage ratios, safety thresholds, and provides scaling recommendations.",
            "promptTriggers": {
                "keywords": [
                    "margin dashboard",
                    "update margin",
                    "margin balance",
                    "margin strategy",
                    "margin living",
                    "coverage ratio",
                    "margin scaling",
                    "margin interest",
                    "portfolio to margin ratio",
                    "margin draw"
                ],
                "intentPatterns": [
                    "(update|sync|check).*?(margin|margin balance|margin dashboard)",
                    "(calculate|check).*?(coverage ratio|margin interest)",
                    "margin.*?(strategy|scaling|alert|threshold)",
                    "update.*?(balances|fidelity balances)"
                ]
            },
            "fileTriggers": {
                "pathPatterns": [
                    "notebooks/updates/Balances_for_Account_*.csv",
                    "fin-guru/data/*margin*.md",
                    "docs/fin-guru/strategies/active/*margin*.md"
                ]
            }
        },
        "formula-protection": {
            "type": "guardrail",
            "enforcement": "block",
            "priority": "critical",
            "description": "Prevent accidental modification of sacred spreadsheet formulas. Blocks edits to GOOGLEFINANCE, calculated columns. Allows only IFERROR wrappers and safe repairs.",
            "promptTriggers": {
                "keywords": [
                    "update formula",
                    "modify formula",
                    "change formula",
                    "fix formula",
                    "edit cell",
                    "update column c",
                    "update column d",
                    "update column e",
                    "googlefinance",
                    "formula error",
                    "#n/a",
                    "#div/0!",
                    "#ref!"
                ],
                "intentPatterns": [
                    "(update|modify|change|edit|fix).*?(formula|column [C-F]|column [H-S])",
                    "(change|update).*?(last price|current value|total g/l)",
                    "fix.*?(#N/A|#DIV/0!|#REF!|formula error)",
                    "(edit|modify|update).*?(spreadsheet formula|google sheets formula)"
                ]
            },
            "fileTriggers": {
                "pathPatterns": [
                    "fin-guru/data/spreadsheet-*.md"
                ]
            }
        }
    },
    "notes": {
        "enforcement_types": {
            "suggest": "Skill suggestion appears but doesn't block execution",
            "block": "Requires skill to be used before proceeding (guardrail)",
            "warn": "Shows warning but allows proceeding"
        },
        "priority_levels": {
            "critical": "Highest - Always trigger when matched",
            "high": "Important - Trigger for most matches",
            "medium": "Moderate - Trigger for clear matches",
            "low": "Optional - Trigger only for explicit matches"
        },
        "customization": {
            "pathPatterns": "Adjust to match your project structure (blog-api, auth-service, etc.)",
            "keywords": "Add domain-specific terms relevant to your project",
            "intentPatterns": "Use regex for flexible user intent matching"
        }
    }
}
